<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!--Link for boostrap-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <!--Link for font awesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

    <!--Link to external file css-->
    <link rel="stylesheet" href="style.css">

    <!--Link for vue.js-->
    <script src="https://unpkg.com/vue"></script>

    <!--Link to external file JavaScript-->
    <script src="lessons.js"></script>

</head>

<body>

    <div id="app">

        <div class="container-fluid">

            <!--First row-->
            <div class="container-fluid">

                <div class="row">
                    <div class="col-lg"></div>

                    <div class="col-lg">

                        <header>

                            <!--Output site name-->
                            <h1 v-text="sitename"></h1>

                            <!--Output basket if cart is not empty-->
                            <button v-if='cart.length > 0' class="basket" v-on:click='showBasket'>

                                {{cartItemCount}}
                                <span class="fas fa-shopping-cart"></span> Basket

                            </button>

                        </header>

                    </div>

                    <div class="col-lg"></div>
                </div>
            </div>

            <br>

            <!--Second row-->
            <div class="container-fluid">

                <div class="row">

                    <main>

                        <div v-if='showProduct'>

                            <!--Outoput products-->
                            <ul v-for="product in products">
                                <div class="output">
                                    <img v-bind:src="product.image" alt="logo.png">
                                    <p>Subject: {{product.title}}</p>
                                    <p>Location: {{product.location}}</p>
                                    <p>Price: £{{product.price}}</p>
                                    <p>Number of spaces: {{product.quantity}}</p>
                                    <button class="add" v-on:click='addToCart(product)'>
                                        <span class="fas fa-cart-plus"></span> Add to cart
                                    </button>
                                    <button class="add" disabled='disabled'>
                                        <span class="fas fa-cart-plus"></span> Add to cart
                                    </button>
                                </div>
                            </ul>

                        </div>

                        <!--Output basket-->
                        <div v-else>


                            <ul v-for="product in cart">
                                <div class="output">
                                    <img v-bind:src="product.image" alt="logo.png">
                                    <p>Subject: {{product.title}}</p>
                                    <p>Location: {{product.location}}</p>
                                    <p>Price: £{{product.price}}</p>
                                    <p>Number of spaces: 1</p>
                                    <button class="add" v-on:click='deleteFromCart(product)'>
                                        <span class="fas fa-trash"></span> Delete
                                    </button>
                                </div>
                            </ul>

                        </div>

                    </main>

                </div>

            </div>

            <br>

            <!--Third row-->
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg"></div>

                    <div class="col-lg"></div>

                    <div class="col-lg"></div>
                </div>
            </div>

        </div>

    </div>

    <script>

        var vueapp = new Vue({
            el: '#app',
            data: {
                sitename: 'After School Club',
                products: lessons,
                cart: [],
                showProduct: true
            },

            methods: {

                //Function to add products to basket and update quantity
                addToCart: function (product) {

                    this.cart.push(product);

                    product.quantity--;
                },

                //Function to check if showProduct is true and show button
                showBasket() {

                    this.showProduct = this.showProduct ? false : true;

                },

                //Function to delete items from basket and update quantity
                deleteFromCart: function (product) {

                    for (let i = 0; i < this.cart.length; i++) {

                        if (this.cart[i].title === product.title) {

                            this.cart.splice(i, 1);

                            product.quantity++;

                            if (this.cart.length === 0) {

                                this.showProduct = true;
                            }
                            break;
                        }
                    }
                }

            },

            computed: {

                //Function to output total number of items from cart
                cartItemCount: function () {

                    return this.cart.length || ' ';

                }

            }
        })

    </script>

</body>

</html>